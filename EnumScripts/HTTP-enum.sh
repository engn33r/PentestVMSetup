#!/bin/bash

#IPv4
ip=10.10.10.100
# IPv6
# ip="-6 ::1"
port=8443

gobuster dir -u http://$ip:$port/ -w /opt/SecLists/Discovery/Web-Content/common.txt -s '200,204,301,302,307,403,500' -e -k
# sslscan https://$ip:$port
#sslscan normally checks port 443, may be different from port 80

#Now for NSE time
echo "Shellshock tests - should enter proper URL to /cgi-bin/bin or cgi-bin/admin or other"
nmap -Pn -p $port --script=http-shellshock --script-args uri=/cgi-bin/bin,cmd=ls $ip
nmap -Pn -p $port --script=http-shellshock --script-args uri=/cgi-bin/admin.cgi,cmd=ls $ip
echo "all other http-vulns test"
echo "test 1 of 3"
nmap -Pn -p $port --script=http-vuln-* $ip
echo "test 2 of 3"
nmap -Pn -p $port --script=http-adobe-coldfusion-apsa1301,http-affiliate-id,http-apache-negotiation,http-apache-server-status,http-aspnet-debug,http-auth-finder,http-auth,http-avaya-ipoffice-users,http-awstatstotals-exec,http-axis2-dir-traversal,http-backup-finder,http-barracuda-dir-traversal,http-bigip-cookie,http-cakephp-version,http-chrono,http-cisco-anyconnect,http-coldfusion-subzero,http-comments-displayer,http-config-backup,http-cookie-flags $ip
echo "test 2.5 of 3"
nmap -Pn -p $port --script=http-cors,http-cross-domain-policy,http-csrf,http-date,http-default-accounts,http-devframework,http-dlink-backdoor,http-dombased-xss,http-domino-enum-passwords,http-enum,http-errors,http-exif-spider,http-favicon,http-feed,http-fetch,http-fileupload-exploiter,http-form-fuzzer,http-frontpage-login,http-generator,http-git,http-gitweb-projects-enum,http-google-malware,http-grep,http-headers,http-huawei-hg5xx-vuln,http-icloud-findmyiphone,http-icloud-sendmsg,http-iis-short-name-brute,http-iis-webdav-vuln,http-internal-ip-disclosure,http-joomla-brute,http-jsonp-detection $ip
echo "test 3 of 3"
nmap -p $port --script=http-litespeed-sourcecode-download,http-ls,http-majordomo2-dir-traversal,http-malware-host,http-mcmp,http-methods,http-method-tamper,http-mobileversion-checker,http-ntlm-info,http-open-proxy,http-open-redirect,http-passwd,http-phpmyadmin-dir-traversal,http-phpself-xss,http-php-version,http-proxy-brute,http-put,http-qnap-nas-info,http-referer-checker,http-rfi-spider,http-robots,http-robtex-reverse-ip,http-robtex-shared-ns,http-security-headers,http-server-header,http-sitemap-generator,http-sql-injection,http-stored-xss,http-svn-enum,http-svn-info,http-title,http-tplink-dir-traversal,http-trace,http-trane-info,http-unsafe-output-escaping,http-useragent-tester,http-userdir-enum,http-vhosts,http-vlcstreamer-ls,http-vmware-path-vuln $ip

# If wordpress...
# wpscan -u $ip
# nmap --script=http-wordpress-brute,http-wordpress-enum,http-wordpress-users -p 80 $ip
# CMSMap
# cmsmap http://$ip

#There's separate drupal scans too
# nmap --script http-drupal-enum,http-drupal-enum-users -p $port $ip
# droopescan scan drupal -u http://$ip:$port 
# CMSMap
# cmsmap http://$ip

nikto -host $ip -port $port

