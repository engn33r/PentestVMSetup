#!/bin/bash

ip=192.168.24.1
# username="Hazard"
# password="stealth1agent" 

date
echo "Performing SMB enumeration for IP " $ip

nbtscan-unixwiz -f $ip
nbtscan $ip
enum4linux -a $ip
#enum4linux -w SUPPORTDESK -u hazard -p stealth1agent -a $ip
nmblookup -A $ip
smbmap -H $ip

# If creds are available, add the following line at the end of the nmap scripts line
# --script-args=smbuser=hazard,smbpass=stealth1agent,smbdomain=SUPPORTDESK

nmap -Pn -sV --script smb2-capabilities,smb2-security-mode,smb2-time,smb2-vuln-uptime,smb-double-pulsar-backdoor,smb-enum-domains,smb-enum-groups,smb-enum-processes,smb-enum-services,smb-enum-sessions,smb-enum-shares,smb-enum-users,smb-ls,smb-mbenum,smb-os-discovery,smb-print-text,smb-protocols,smb-psexec,smb-security-mode,smb-server-stats,smb-system-info,smb-vuln-conficker,smb-vuln-cve2009-3103,smb-vuln-cve-2017-7494,smb-vuln-ms06-025,smb-vuln-ms07-029,smb-vuln-ms08-067,smb-vuln-ms10-054,smb-vuln-ms10-061,smb-vuln-ms17-010,smb-vuln-regsvc-dos -p 139,445 $ip #--script-args=smbuser=hazard,smbpass=stealth1agent,smbdomain=SUPPORTDESK
#rpcclient -U "hazard" $ip
rpcclient -U "" -N $ip
smbclient -L //$ip

echo "perform smb-brute separate if you wish"
